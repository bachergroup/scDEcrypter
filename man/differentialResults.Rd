% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/output_funcs.R
\name{differentialResults}
\alias{differentialResults}
\title{Perform Differential Expression Analysis on Test Data}
\usage{
differentialResults(mod_results, testData, testingGenes, compGroups)
}
\arguments{
\item{mod_results}{A list containing model fitting results from \code{\link{fit_scDEcrypter}}.}

\item{testData}{A Seurat object or list containing test data with:
\describe{
\item{\code{RNA}}{RNA assay with \code{data.Test} slot containing test counts}
\item{\code{C.preLabel}}{Observed cell type labels for test cells in metadata}
\item{\code{V.preLabel}}{Observed viral status labels for test cells in metadata}
}}

\item{testingGenes}{Character vector of gene names for which to perform differential
expression testing. Should be a larger set of genes for testing.}

\item{compGroups}{vector specifying pairwise comparisons to perform. Structure should
indicate which /viral type pairs to compare (e.g., infected vs. uninfected).}
}
\value{
A list containing differential expression results:
\describe{
\item{\code{ll.alternative}}{Log-likelihood under alternative (full) model (genes x cell types)}
\item{\code{ll.null}}{Log-likelihood under null model (genes x cell types)}
\item{\code{lrt.stat}}{Likelihood ratio test statistics (genes x cell types)}
\item{\code{pval}}{Chi-squared p-values (genes x cell types)}
\item{\code{adj.pval}}{FDR-adjusted p-values (genes x cell types)}
\item{\code{logfc}}{Log-fold changes between compared groups}
}
}
\description{
Conducts likelihood ratio testing for differential expression by comparing
alternative and null models fitted to test data. Computes log-likelihoods,
test statistics, p-values, and log-fold changes for genes across cell type
and viral type combinations.
}
\details{
The function fits two models to test data: (1) an alternative model allowing
separate means for each comparison group, and (2) a null model with constrained
means. A likelihood ratio test compares these nested models for each gene and
cell type. P-values are computed from a chi-squared distribution with 1 degree
of freedom and adjusted for multiple testing using the false discovery rate.
}
