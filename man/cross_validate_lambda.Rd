% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cross_validate_lambda.R
\name{cross_validate_lambda}
\alias{cross_validate_lambda}
\title{Cross-validation for Lambda Selection}
\usage{
cross_validate_lambda(
  Y_generation,
  C.obs_generation,
  V.obs_generation,
  lambda.vec,
  max.iter,
  tol,
  C.star,
  V.star,
  seed,
  NCORES,
  K = 5
)
}
\arguments{
\item{Y_generation}{Numeric matrix of dimension \code{n x p}, training data.
Each row is a sample (cell), each column is a feature (e.g. gene).}

\item{C.obs_generation}{Integer vector of length \code{n}, observed condition
labels (may contain \code{NA}).}

\item{V.obs_generation}{Integer vector of length \code{n}, observed variant
labels (may contain \code{NA}).}

\item{lambda.vec}{Numeric vector. Candidate \eqn{\lambda} values to be
cross-validated.}

\item{max.iter}{Integer. Maximum number of EM iterations for
\code{MultiwayMixture}.}

\item{tol}{Numeric. Convergence tolerance for EM updates.}

\item{C.star}{Integer. Prespecified number of latent conditions.}

\item{V.star}{Integer. Prespecified number of latent variants.}

\item{seed}{Integer. Random seed for reproducibility.}

\item{NCORES}{Integer. Number of cores for parallel computation.}

\item{K}{Integer. Number of cross-validation folds. Defaults to 5.}
}
\value{
A list with components:
\describe{
\item{\code{best_lambda}}{The \eqn{\lambda} value with highest average
validation log-likelihood.}
\item{\code{lambda_log_likelihoods}}{Matrix of log-likelihoods, rows =
\code{lambda.vec}, columns = folds.}
\item{\code{avg_log_likelihoods}}{Vector of mean log-likelihoods across folds.}
}
}
\description{
Performs K-fold cross-validation to select the best penalty parameter
\eqn{\lambda} for the \code{MultiwayMixture} model. Each fold splits the
data into training and validation sets, fits the model on training data
across candidate \eqn{\lambda} values, and evaluates log-likelihood on
validation data. The best \eqn{\lambda} is chosen by maximizing the
average validation log-likelihood across folds.
}
