% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/M_step.R
\name{M_step_variance}
\alias{M_step_variance}
\title{Estimate Variance Parameters (M-step)}
\usage{
M_step_variance(Y, W, M)
}
\arguments{
\item{Y}{A numeric matrix of dimension \eqn{(n \times p)}, where
\eqn{n} is the number of samples (cells) and \eqn{p} is the
number of features (genes).}

\item{W}{A numeric array of dimension \eqn{(n \times C \times V)} containing
posterior weights for each sample, cell type, and condition.}

\item{M}{A numeric array of dimension \eqn{(p \times C \times V)} containing
current mean estimates.}
}
\value{
A numeric array of dimension \eqn{(p \times C \times V)} with updated
variance estimates. Each entry is the weighted variance with a minimum floor of 0.1.
}
\description{
Computes variance estimates for a multiway mixture model using
weighted squared deviations from current mean estimates.
}
\details{
Computes variance as:
\eqn{\sigma^2[j, c, v] = \max\left(\frac{\sum_i W[i, c, v] * (Y[i, j] - M[j, c, v])^2}{\sum_i W[i, c, v]}, 0.1\right)}

The floor of 0.1 prevents numerical issues with very small variances.
}
\keyword{internal}
