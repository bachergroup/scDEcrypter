% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/output_funcs.R
\name{thresholdScoring}
\alias{thresholdScoring}
\title{Score Cell Type and Viral Status Labels via Thresholding on Test Data}
\usage{
thresholdScoring(
  mod_results,
  testData,
  cutoffInfection = 0.9,
  cutoffPartition = "max",
  independentThres = TRUE
)
}
\arguments{
\item{mod_results}{A list containing model fitting results from \code{\link{fit_scDEcrypter}}.}

\item{testData}{A Seurat object or list containing test data with:
\describe{
\item{\code{RNA}}{RNA assay with \code{data.Test} slot containing test counts}
\item{\code{C.preLabel}}{Observed cell type labels for test cells in metadata}
\item{\code{V.preLabel}}{Observed viral status labels for test cells in metadata}
}}

\item{cutoffInfection}{Numeric threshold in \code{[0,1]} for viral status prediction,
or \code{"max"} to select the infection status with highest weight. Default: \code{0.9}.}

\item{cutoffPartition}{Numeric threshold in \code{[0,1]} for cell type prediction,
or \code{"max"} to select the cell type with highest weight. Default: \code{"max"}.}

\item{independentThres}{Logical. If \code{TRUE} (default), cell type and viral status
are predicted independently by marginalizing over the other dimension. If \code{FALSE},
joint predictions are made using the maximum weight across both dimensions.}
}
\value{
The input \code{testData} object with two additional columns added to metadata:
\describe{
\item{\code{Infection_pred}}{Predicted viral infection status labels (Unknown = uninfected/uncertain)}
\item{\code{Partition_pred}}{Predicted partition variable (e.g., cell type) labels (Unknown = unclassified/uncertain)}
}
A value of Unknown indicates the cell could not be confidently assigned (either multiple
dimensions exceeded threshold or none exceeded threshold).
}
\description{
Assigns cell type and viral infection status labels to test cells
based on conditional weights. Assignments can be made using independent or
joint thresholding approaches.
}
\details{
When \code{independentThres = TRUE}, the function sums weights across the alternative
dimension (e.g., summing across viral types when predicting cell type). This marginalizes
out uncertainty in the other dimension.

When \code{independentThres = FALSE}, the maximum weight is taken across each dimension
separately, then thresholding is applied. This provides joint predictions.

Numeric thresholds allow for conservative (higher threshold) or liberal (lower threshold)
predictions. The special value \code{"max"} assigns each cell to the category with
highest weight, which always produces a definitive assignment unless there are ties (returns as Unknown).
}
